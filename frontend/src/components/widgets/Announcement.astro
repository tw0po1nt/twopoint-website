---
export interface Props {
  title: string;
  href: string;
  publishDate: Date;
}

const { title, href, publishDate } = Astro.props;
const publishDateISO = publishDate.toISOString();
---

<div
  id="announcement-banner"
  data-publish-date={publishDateISO}
  class="dark text-muted text-sm bg-black dark:bg-transparent dark:border-b dark:border-slate-800 dark:text-slate-400 hidden md:flex gap-1 overflow-hidden px-3 py-2 relative text-ellipsis whitespace-nowrap"
>
  <span
    class="dark:bg-slate-700 bg-white/40 dark:text-slate-300 font-semibold px-1 py-0.5 text-xs mr-0.5 rtl:mr-0 rtl:ml-0.5 inline-block"
    >UPCOMING</span
  >
  <a href={href} class="text-muted hover:underline dark:text-slate-400 font-medium"
    >{title} Â»</a
  >
</div>

<script>
  // Check if the upcoming post's publish date has passed
  function checkAnnouncementVisibility() {
    const banner = document.getElementById('announcement-banner');
    if (!banner) return;

    const publishDateStr = banner.getAttribute('data-publish-date');
    if (!publishDateStr) return;

    const publishDate = new Date(publishDateStr);
    const now = new Date();

    // If the publish date has passed, hide the banner
    if (now >= publishDate) {
      banner.style.display = 'none';
    }
  }

  // Run on page load
  checkAnnouncementVisibility();
</script>
